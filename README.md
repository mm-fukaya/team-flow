# Git Status - GitHub活動データ表示アプリ

GitHubからメンバーごとの活動データ（イシュー作成数、プルリクエスト作成数、コミット数、レビュー数）を取得して表示するWebアプリケーションです。

## 🚀 機能

- **期間選択**: 柔軟な期間設定（デフォルト3ヶ月、最大1年）
- **月単位グラフ**: Chart.jsを使用した美しい棒グラフ表示
- **メンバー選択**: 検索機能付きドロップダウン
- **データ保存**: ローカルでのデータ永続化
- **複数組織対応**: 複数のGitHub組織を設定可能
- **テストモード**: 少ないデータで安全にテスト可能
- **レート制限表示**: GitHub APIのレート制限状況をリアルタイム表示
- **エラーハンドリング**: 堅牢なエラー処理とフォールバック機能

## 🛠 技術スタック

### フロントエンド
- **React 18** - 最新のReact機能を活用
- **TypeScript** - 型安全性の確保
- **Chart.js + react-chartjs-2** - インタラクティブなグラフ表示
- **Tailwind CSS** - モダンなUIデザイン
- **Axios** - HTTP通信
- **Moment.js** - 日付処理

### バックエンド
- **Node.js** - サーバーサイド実行環境
- **Express** - Webフレームワーク
- **TypeScript** - 型安全性の確保
- **GitHub REST API v3** - 基本的なデータ取得
- **GitHub GraphQL API** - 効率的なPR・レビュー取得
- **Octokit** - GitHub APIクライアント

## 📦 セットアップ

### 1. 依存関係のインストール

```bash
npm run install-all
```

### 2. 環境変数の設定

バックエンドディレクトリに`.env`ファイルを作成：

```bash
cd backend
cp env.example .env
```

`.env`ファイルを編集してGitHubトークンを設定：

```env
GITHUB_TOKEN=your_github_personal_access_token_here
PORT=3001
```

### 3. GitHubトークンの取得

1. GitHubにログイン
2. Settings > Developer settings > Personal access tokens > Tokens (classic)
3. "Generate new token(classic)"をクリック
4. 以下の権限を付与：
   - `repo` (プライベートリポジトリにアクセスする場合)
   - `read:org` (組織のメンバー情報を取得)
   - `read:user` (ユーザー情報を取得)

**重要**: 組織でSAML認証が有効な場合、トークンに組織アクセス権限を付与する必要があります。

### 4. 組織の設定

`config/organizations.json`を編集して対象のGitHub組織を設定：

```json
{
  "organizations": [
    {
      "name": "your-org-name",
      "displayName": "Your Organization Display Name"
    }
  ]
}
```

### 5. アプリケーションの起動

```bash
npm run dev
```

- **フロントエンド**: http://localhost:3000
- **バックエンド**: http://localhost:3001

## 📊 使用方法

1. **組織選択**: ドロップダウンから対象組織を選択
2. **期間設定**: 開始日と終了日を設定（デフォルト3ヶ月前から今日まで）
3. **モード選択**: 
   - **テストモード**: 少ないデータで安全にテスト
   - **本番モード**: 全データを取得
4. **データ取得**: 「データ取得」ボタンをクリック
5. **メンバー選択**: 活動データを表示したいメンバーを選択
6. **グラフ表示**: 月単位の活動データが棒グラフで表示

## 🔧 データ取得の仕組み

### 取得可能なデータ量
- **イシュー**: 最大1000個/リポジトリ × 1000リポジトリ = 100万個
- **コミット**: 最大1000個/リポジトリ × 1000リポジトリ = 100万個
- **PR**: 最大500個/リポジトリ × 20リポジトリ = 1万個
- **レビュー**: 最大400個/PR × 500PR = 20万個

### 取得方式
1. **GraphQL API**: PR・レビューの効率的な一括取得
2. **REST API**: イシュー・コミットの詳細取得
3. **フォールバック**: GraphQL失敗時のREST API自動切り替え

### パフォーマンス最適化
- **並列処理**: 最大10リポジトリを同時処理
- **ページネーション**: 大量データの効率的な取得
- **レート制限対応**: 自動的なリクエスト間隔調整
- **エラーハンドリング**: 空リポジトリや存在しないリポジトリの適切な処理

## 💾 データの保存

取得したデータは`backend/data/member-activities.json`に保存され、次回以降はローカルデータを使用します。

## ⚠️ 注意事項

### GitHub API制限
- **REST API**: 1時間あたり5,000リクエスト
- **GraphQL API**: 1時間あたり5,000リクエスト
- **GraphQLノード制限**: 最大500,000ノード

### パフォーマンス
- 大量のデータを取得する場合は時間がかかる場合があります
- 本番モードでは最大10ページ（1000個/リポジトリ）まで取得
- レート制限に達した場合は自動的に待機

### 権限
- プライベートリポジトリにアクセスする場合は、適切な権限を持つGitHubトークンが必要
- 組織でSAML認証が有効な場合、トークンに組織アクセス権限を付与

## 🐛 トラブルシューティング

### よくある問題

1. **メンバーが表示されない**
   - GitHubトークンの権限を確認（`read:org`が必要）
   - 組織のSAML認証設定を確認

2. **データが少ない**
   - 期間設定を確認
   - テストモードが有効になっていないか確認
   - 組織設定が正しいか確認

3. **GraphQLエラー**
   - 自動的にREST APIにフォールバックされます
   - ログで「GraphQL取得失敗、REST APIにフォールバック」を確認

4. **レート制限エラー**
   - 画面上部のレート制限情報を確認
   - しばらく待ってから再試行

## 🔄 更新履歴

### v1.1.0 (最新)
- GraphQL制限の適切な調整
- REST APIフォールバック機能
- ページネーション対応
- パフォーマンス改善
- 日付フィルタリング改善
- エラーハンドリング強化

### v1.0.0
- 基本的な機能実装
- GitHub API連携
- グラフ表示機能

## 📄 ライセンス

MIT License

## 🤝 コントリビューション

プルリクエストやイシューの報告を歓迎します。 